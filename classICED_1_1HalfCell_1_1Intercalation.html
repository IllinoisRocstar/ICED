<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>ICED_Physics: Intercalation Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="iced_logo_small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">ICED_Physics
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">ICED: llinois Rocstarâ€™s Integrated Computational Environment for Electrochemical Device Design (ICED)</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classICED_1_1HalfCell_1_1Intercalation.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classICED_1_1HalfCell_1_1Intercalation-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Intercalation Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The <a class="el" href="classICED_1_1HalfCell_1_1Intercalation.html" title="The Intercalation function is a module that solves the time-dependent, second-order diffusion equatio...">Intercalation</a> function is a module that solves the time-dependent, second-order diffusion equation for ion migration in the solid.  
 <a href="classICED_1_1HalfCell_1_1Intercalation.html#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The <a class="el" href="classICED_1_1HalfCell_1_1Intercalation.html" title="The Intercalation function is a module that solves the time-dependent, second-order diffusion equatio...">Intercalation</a> function is a module that solves the time-dependent, second-order diffusion equation for ion migration in the solid. </p>
<p>The <a class="el" href="classICED_1_1HalfCell_1_1Intercalation.html" title="The Intercalation function is a module that solves the time-dependent, second-order diffusion equatio...">Intercalation</a> function is a module that solves the time-dependent, second-order diffusion equation for ion migration in the solid. </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial c_s}{\partial t} = \frac{1}{r^2}\frac{\partial}{\partial r} \left[r^2 D_s \frac{\partial c_s}{\partial r}\right] \]" src="form_25.png"/>
</p>
<p> The active material is assumed to be made up of spherical particles of radius <img class="formulaInl" alt="$R$" src="form_43.png"/> with (solid state) diffusion being the mechanism for transport. We take the direction normal to the surface of the particles to be the <img class="formulaInl" alt="$r$" src="form_44.png"/> direction. Here <img class="formulaInl" alt="$c_s$" src="form_2.png"/> represents the concentration of the ions in the solid particle phase. If <img class="formulaInl" alt="$ D_s $" src="form_45.png"/>, the solid diffusion coefficient, is (approximately) constant, then the concentration in the particle resulting from a time-varying rate of reaction at the surface can be obtained by superposing the concentration changes resulting from simple step changes in concentration at the surface.</p>
<p>The <a class="el" href="classICED_1_1HalfCell_1_1Intercalation.html" title="The Intercalation function is a module that solves the time-dependent, second-order diffusion equatio...">Intercalation</a> module couples with the governing equations through the <a class="el" href="classICED_1_1HalfCell_1_1WallFlux.html" title="Physics module for Wall Flux. ">WallFlux</a> <img class="formulaInl" alt="$ j_n $" src="form_46.png"/>. The function evaluation then becomes </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ f_{kn} = j_{kn} + D_s \left(\frac{\partial c_s}{\partial r}\right)_{kn} \]" src="form_47.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ f_{kn} = j_{kn} + D_s \frac {c_{kn}-c_{(k-1)n}}{\Delta t} A_{1n} + D_s \sum_{j=0}^{k-2} \frac{c_{(j+1)n}-c_{jn}}{\Delta t} A_{(k-j)n}\]" src="form_48.png"/>
</p>
<p>where <img class="formulaInl" alt="$c_{kn}$" src="form_49.png"/> is the concentration of lithium ions in the solid and <img class="formulaInl" alt="$A_{kn}$" src="form_50.png"/> is the series expansion constant, both at spatial point <img class="formulaInl" alt="$n$" src="form_18.png"/> and temporal time <img class="formulaInl" alt="$k$" src="form_51.png"/> Note that <img class="formulaInl" alt="$n$" src="form_18.png"/> has been dropped from the <a class="el" href="classICED_1_1HalfCell_1_1WallFlux.html" title="Physics module for Wall Flux. ">WallFlux</a> term to avoid confusion.</p>
<p><img class="formulaInl" alt="$ D_s $" src="form_45.png"/> comes from the input file, and <img class="formulaInl" alt="$A$" src="form_52.png"/> is related to <img class="formulaInl" alt="$a(t)$" src="form_53.png"/> through the below equation. </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[\frac{D}{R} A_{kn} = a(t_k) - a(t_{k-1})\]" src="form_54.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[= \frac{D}{R} \int_{0}^{t_k} \frac{\partial c_n}{\partial r}\left(R,\delta\right) d\delta - \frac{D}{R} \int_{0}^{t_{k-1}} \frac{\partial c_n}{\partial r}\left(R,\delta\right) d\delta \]" src="form_55.png"/>
</p>
<p> We use a Laplace transform to obtain series expansions for <img class="formulaInl" alt="$a(t)$" src="form_53.png"/>. A substitution occurs to change from dimensioned time <img class="formulaInl" alt="$t$" src="form_56.png"/> to dimensionless time <img class="formulaInl" alt="$\tau$" src="form_57.png"/>. <img class="formulaInl" alt="$a(\tau)$" src="form_58.png"/> is obtained from CalcATK . </p>

<p>Definition at line <a class="el" href="PhysicsModule_8hpp_source.html#l00985">985</a> of file <a class="el" href="PhysicsModule_8hpp_source.html">PhysicsModule.hpp</a>.</p>
</div>
<p><code>#include &lt;<a class="el" href="PhysicsModule_8hpp_source.html">Physics/include/PhysicsModule.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a6881fc85d2151cfe38a90f57f5846eaf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classICED_1_1HalfCell_1_1Intercalation.html#a6881fc85d2151cfe38a90f57f5846eaf">Intercalation</a> ()</td></tr>
<tr class="memdesc:a6881fc85d2151cfe38a90f57f5846eaf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor.  <a href="#a6881fc85d2151cfe38a90f57f5846eaf">More...</a><br/></td></tr>
<tr class="separator:a6881fc85d2151cfe38a90f57f5846eaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1b92c90c5d008a339742fb7454d7a4a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classICED_1_1HalfCell_1_1Intercalation.html#ad1b92c90c5d008a339742fb7454d7a4a">Intercalation</a> (<a class="el" href="classICED_1_1HalfCell_1_1SolutionData.html">SolutionData</a> *solutionData, <a class="el" href="namespaceICED_1_1HalfCell.html#adaeddb6c345f1909b8c0482219d3147b">GlobalType</a> &amp;globin)</td></tr>
<tr class="memdesc:ad1b92c90c5d008a339742fb7454d7a4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor for solution data and global object.  <a href="#ad1b92c90c5d008a339742fb7454d7a4a">More...</a><br/></td></tr>
<tr class="separator:ad1b92c90c5d008a339742fb7454d7a4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac72e7caf7275f523a8096924012e434"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classICED_1_1HalfCell_1_1Intercalation.html#aac72e7caf7275f523a8096924012e434">~Intercalation</a> ()</td></tr>
<tr class="memdesc:aac72e7caf7275f523a8096924012e434"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default destructor.  <a href="#aac72e7caf7275f523a8096924012e434">More...</a><br/></td></tr>
<tr class="separator:aac72e7caf7275f523a8096924012e434"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98b1050f09da390896f964fb7a892391"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classICED_1_1HalfCell_1_1Intercalation.html#a98b1050f09da390896f964fb7a892391">Initialize</a> ()</td></tr>
<tr class="memdesc:a98b1050f09da390896f964fb7a892391"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialization of the member data.  <a href="#a98b1050f09da390896f964fb7a892391">More...</a><br/></td></tr>
<tr class="separator:a98b1050f09da390896f964fb7a892391"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfbdf2d6a1bd474786c2f1c0bdf14dde"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classICED_1_1HalfCell_1_1Intercalation.html#acfbdf2d6a1bd474786c2f1c0bdf14dde">SolvePhysics</a> ()</td></tr>
<tr class="memdesc:acfbdf2d6a1bd474786c2f1c0bdf14dde"><td class="mdescLeft">&#160;</td><td class="mdescRight">Physics solution.  <a href="#acfbdf2d6a1bd474786c2f1c0bdf14dde">More...</a><br/></td></tr>
<tr class="separator:acfbdf2d6a1bd474786c2f1c0bdf14dde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b92f2697bb5f43111ccff9ef55ebef3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classICED_1_1HalfCell_1_1Intercalation.html#a9b92f2697bb5f43111ccff9ef55ebef3">InitializePhysics</a> ()</td></tr>
<tr class="memdesc:a9b92f2697bb5f43111ccff9ef55ebef3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Physics solution initialization.  <a href="#a9b92f2697bb5f43111ccff9ef55ebef3">More...</a><br/></td></tr>
<tr class="separator:a9b92f2697bb5f43111ccff9ef55ebef3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe661c3679eae6d6f40f0d6c4f38442b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classICED_1_1HalfCell_1_1Intercalation.html#abe661c3679eae6d6f40f0d6c4f38442b">CalcATK</a> (const double &amp;tau)</td></tr>
<tr class="memdesc:abe661c3679eae6d6f40f0d6c4f38442b"><td class="mdescLeft">&#160;</td><td class="mdescRight">A Laplace transform is used to obtain series expansions for <img class="formulaInl" alt="$a(\tau)$" src="form_58.png"/>.  <a href="#abe661c3679eae6d6f40f0d6c4f38442b">More...</a><br/></td></tr>
<tr class="separator:abe661c3679eae6d6f40f0d6c4f38442b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classICED_1_1HalfCell_1_1PhysicsModule"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classICED_1_1HalfCell_1_1PhysicsModule')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classICED_1_1HalfCell_1_1PhysicsModule.html">PhysicsModule</a></td></tr>
<tr class="memitem:afb8cce1b77073af99ba9fbd3de17f1c7 inherit pub_methods_classICED_1_1HalfCell_1_1PhysicsModule"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classICED_1_1HalfCell_1_1PhysicsModule.html#afb8cce1b77073af99ba9fbd3de17f1c7">PhysicsModule</a> ()</td></tr>
<tr class="memdesc:afb8cce1b77073af99ba9fbd3de17f1c7 inherit pub_methods_classICED_1_1HalfCell_1_1PhysicsModule"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor.  <a href="#afb8cce1b77073af99ba9fbd3de17f1c7">More...</a><br/></td></tr>
<tr class="separator:afb8cce1b77073af99ba9fbd3de17f1c7 inherit pub_methods_classICED_1_1HalfCell_1_1PhysicsModule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef8f28d1e7475aaf65f2bf8e66b3729c inherit pub_methods_classICED_1_1HalfCell_1_1PhysicsModule"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classICED_1_1HalfCell_1_1PhysicsModule.html#aef8f28d1e7475aaf65f2bf8e66b3729c">PhysicsModule</a> (<a class="el" href="classICED_1_1HalfCell_1_1SolutionData.html">SolutionData</a> *solutionData, <a class="el" href="namespaceICED_1_1HalfCell.html#adaeddb6c345f1909b8c0482219d3147b">GlobalType</a> &amp;globin)</td></tr>
<tr class="memdesc:aef8f28d1e7475aaf65f2bf8e66b3729c inherit pub_methods_classICED_1_1HalfCell_1_1PhysicsModule"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor for solution data and global object.  <a href="#aef8f28d1e7475aaf65f2bf8e66b3729c">More...</a><br/></td></tr>
<tr class="separator:aef8f28d1e7475aaf65f2bf8e66b3729c inherit pub_methods_classICED_1_1HalfCell_1_1PhysicsModule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad93acb63a5e74e1360dc36f3d664f80d inherit pub_methods_classICED_1_1HalfCell_1_1PhysicsModule"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classICED_1_1HalfCell_1_1PhysicsModule.html#ad93acb63a5e74e1360dc36f3d664f80d">~PhysicsModule</a> ()</td></tr>
<tr class="memdesc:ad93acb63a5e74e1360dc36f3d664f80d inherit pub_methods_classICED_1_1HalfCell_1_1PhysicsModule"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default destructor.  <a href="#ad93acb63a5e74e1360dc36f3d664f80d">More...</a><br/></td></tr>
<tr class="separator:ad93acb63a5e74e1360dc36f3d664f80d inherit pub_methods_classICED_1_1HalfCell_1_1PhysicsModule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98b1050f09da390896f964fb7a892391 inherit pub_methods_classICED_1_1HalfCell_1_1PhysicsModule"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classICED_1_1HalfCell_1_1PhysicsModule.html#a98b1050f09da390896f964fb7a892391">Initialize</a> ()</td></tr>
<tr class="memdesc:a98b1050f09da390896f964fb7a892391 inherit pub_methods_classICED_1_1HalfCell_1_1PhysicsModule"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialization of the member data.  <a href="#a98b1050f09da390896f964fb7a892391">More...</a><br/></td></tr>
<tr class="separator:a98b1050f09da390896f964fb7a892391 inherit pub_methods_classICED_1_1HalfCell_1_1PhysicsModule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acaa045770173553f4697d9e466d4531a inherit pub_methods_classICED_1_1HalfCell_1_1PhysicsModule"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classICED_1_1HalfCell_1_1PhysicsModule.html#acaa045770173553f4697d9e466d4531a">ApplyDirichletBC</a> (int position, double value)</td></tr>
<tr class="memdesc:acaa045770173553f4697d9e466d4531a inherit pub_methods_classICED_1_1HalfCell_1_1PhysicsModule"><td class="mdescLeft">&#160;</td><td class="mdescRight">Application of Dirichlet boundary conditions.  <a href="#acaa045770173553f4697d9e466d4531a">More...</a><br/></td></tr>
<tr class="separator:acaa045770173553f4697d9e466d4531a inherit pub_methods_classICED_1_1HalfCell_1_1PhysicsModule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7978f8b320c3e7e19c5b751e14bbf59 inherit pub_methods_classICED_1_1HalfCell_1_1PhysicsModule"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classICED_1_1HalfCell_1_1PhysicsModule.html#ae7978f8b320c3e7e19c5b751e14bbf59">ApplyNeumannBC</a> (int position, double value)</td></tr>
<tr class="memdesc:ae7978f8b320c3e7e19c5b751e14bbf59 inherit pub_methods_classICED_1_1HalfCell_1_1PhysicsModule"><td class="mdescLeft">&#160;</td><td class="mdescRight">Application of Neumann boundary conditions.  <a href="#ae7978f8b320c3e7e19c5b751e14bbf59">More...</a><br/></td></tr>
<tr class="separator:ae7978f8b320c3e7e19c5b751e14bbf59 inherit pub_methods_classICED_1_1HalfCell_1_1PhysicsModule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29f30f95e80ec3cc7239cbfcfebc9cd9 inherit pub_methods_classICED_1_1HalfCell_1_1PhysicsModule"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classICED_1_1HalfCell_1_1PhysicsModule.html#a29f30f95e80ec3cc7239cbfcfebc9cd9">SetPriority</a> (int priority)</td></tr>
<tr class="memdesc:a29f30f95e80ec3cc7239cbfcfebc9cd9 inherit pub_methods_classICED_1_1HalfCell_1_1PhysicsModule"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set Module Priority.  <a href="#a29f30f95e80ec3cc7239cbfcfebc9cd9">More...</a><br/></td></tr>
<tr class="separator:a29f30f95e80ec3cc7239cbfcfebc9cd9 inherit pub_methods_classICED_1_1HalfCell_1_1PhysicsModule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84ea872c3e4d61853403bd519f655812 inherit pub_methods_classICED_1_1HalfCell_1_1PhysicsModule"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classICED_1_1HalfCell_1_1PhysicsModule.html#a84ea872c3e4d61853403bd519f655812">CheckParams</a> (IRAD::Util::Parameters &amp;componentParameters)</td></tr>
<tr class="memdesc:a84ea872c3e4d61853403bd519f655812 inherit pub_methods_classICED_1_1HalfCell_1_1PhysicsModule"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check input parameters.  <a href="#a84ea872c3e4d61853403bd519f655812">More...</a><br/></td></tr>
<tr class="separator:a84ea872c3e4d61853403bd519f655812 inherit pub_methods_classICED_1_1HalfCell_1_1PhysicsModule"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a2f31d252598029062370e89c338a3cf1"><td class="memItemLeft" align="right" valign="top">std::list&lt; std::vector&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classICED_1_1HalfCell_1_1Intercalation.html#a2f31d252598029062370e89c338a3cf1">prevConcS</a></td></tr>
<tr class="memdesc:a2f31d252598029062370e89c338a3cf1"><td class="mdescLeft">&#160;</td><td class="mdescRight">conc_s at previous time steps.  <a href="#a2f31d252598029062370e89c338a3cf1">More...</a><br/></td></tr>
<tr class="separator:a2f31d252598029062370e89c338a3cf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d39b99b2b3ecf1edc8636bc140abcd5"><td class="memItemLeft" align="right" valign="top">std::list&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classICED_1_1HalfCell_1_1Intercalation.html#a2d39b99b2b3ecf1edc8636bc140abcd5">prevTime</a></td></tr>
<tr class="memdesc:a2d39b99b2b3ecf1edc8636bc140abcd5"><td class="mdescLeft">&#160;</td><td class="mdescRight">the list of times  <a href="#a2d39b99b2b3ecf1edc8636bc140abcd5">More...</a><br/></td></tr>
<tr class="separator:a2d39b99b2b3ecf1edc8636bc140abcd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c93a72506183b41a021ecb0c00c113f"><td class="memItemLeft" align="right" valign="top">std::list&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classICED_1_1HalfCell_1_1Intercalation.html#a8c93a72506183b41a021ecb0c00c113f">aTK</a></td></tr>
<tr class="memdesc:a8c93a72506183b41a021ecb0c00c113f"><td class="mdescLeft">&#160;</td><td class="mdescRight">a list of a (surface area of the pore walls per unit volume) at every time step.  <a href="#a8c93a72506183b41a021ecb0c00c113f">More...</a><br/></td></tr>
<tr class="separator:a8c93a72506183b41a021ecb0c00c113f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_attribs_classICED_1_1HalfCell_1_1PhysicsModule"><td colspan="2" onclick="javascript:toggleInherit('pub_attribs_classICED_1_1HalfCell_1_1PhysicsModule')"><img src="closed.png" alt="-"/>&#160;Public Attributes inherited from <a class="el" href="classICED_1_1HalfCell_1_1PhysicsModule.html">PhysicsModule</a></td></tr>
<tr class="memitem:a18674158a96f67741ee3923729b39aae inherit pub_attribs_classICED_1_1HalfCell_1_1PhysicsModule"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classICED_1_1HalfCell_1_1SolutionData.html">ICED::HalfCell::SolutionData</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classICED_1_1HalfCell_1_1PhysicsModule.html#a18674158a96f67741ee3923729b39aae">pSolutionData</a></td></tr>
<tr class="memdesc:a18674158a96f67741ee3923729b39aae inherit pub_attribs_classICED_1_1HalfCell_1_1PhysicsModule"><td class="mdescLeft">&#160;</td><td class="mdescRight">member data  <a href="#a18674158a96f67741ee3923729b39aae">More...</a><br/></td></tr>
<tr class="separator:a18674158a96f67741ee3923729b39aae inherit pub_attribs_classICED_1_1HalfCell_1_1PhysicsModule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73ebaa7a7e6791d96c63555ae1fefe26 inherit pub_attribs_classICED_1_1HalfCell_1_1PhysicsModule"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceICED_1_1HalfCell.html#ab17cffca265630e7a0003ffcb3ebbe02">solutionVariable_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classICED_1_1HalfCell_1_1PhysicsModule.html#a73ebaa7a7e6791d96c63555ae1fefe26">variableIndex</a></td></tr>
<tr class="memdesc:a73ebaa7a7e6791d96c63555ae1fefe26 inherit pub_attribs_classICED_1_1HalfCell_1_1PhysicsModule"><td class="mdescLeft">&#160;</td><td class="mdescRight">denotes the solution variable, this is set to solutionVariable_t_MAX if the module does not participate in the global solution matrix this is the case for modules that provide spatially varying parameters Populated in each subclass in the initialize function  <a href="#a73ebaa7a7e6791d96c63555ae1fefe26">More...</a><br/></td></tr>
<tr class="separator:a73ebaa7a7e6791d96c63555ae1fefe26 inherit pub_attribs_classICED_1_1HalfCell_1_1PhysicsModule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac37967782f9164e88f136226cfdb7d7d inherit pub_attribs_classICED_1_1HalfCell_1_1PhysicsModule"><td class="memItemLeft" align="right" valign="top">IRAD::Util::Parameters&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classICED_1_1HalfCell_1_1PhysicsModule.html#ac37967782f9164e88f136226cfdb7d7d">idealParameters</a></td></tr>
<tr class="memdesc:ac37967782f9164e88f136226cfdb7d7d inherit pub_attribs_classICED_1_1HalfCell_1_1PhysicsModule"><td class="mdescLeft">&#160;</td><td class="mdescRight">The required parameters that need to be set in the input file for proper module operation Populated in each subclass in the initialize function.  <a href="#ac37967782f9164e88f136226cfdb7d7d">More...</a><br/></td></tr>
<tr class="separator:ac37967782f9164e88f136226cfdb7d7d inherit pub_attribs_classICED_1_1HalfCell_1_1PhysicsModule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33bfba8d979c5f8e04408d23d7abb94f inherit pub_attribs_classICED_1_1HalfCell_1_1PhysicsModule"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classICED_1_1HalfCell_1_1PhysicsModule.html#a33bfba8d979c5f8e04408d23d7abb94f">moduleName</a></td></tr>
<tr class="separator:a33bfba8d979c5f8e04408d23d7abb94f inherit pub_attribs_classICED_1_1HalfCell_1_1PhysicsModule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1197836b231887174e4970963fb0121 inherit pub_attribs_classICED_1_1HalfCell_1_1PhysicsModule"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classICED_1_1HalfCell_1_1PhysicsModule.html#ad1197836b231887174e4970963fb0121">modulePriority</a></td></tr>
<tr class="separator:ad1197836b231887174e4970963fb0121 inherit pub_attribs_classICED_1_1HalfCell_1_1PhysicsModule"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<div class="dynheader">
Inheritance diagram for Intercalation:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classICED_1_1HalfCell_1_1Intercalation__inherit__graph.svg" width="120" height="187"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for Intercalation:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classICED_1_1HalfCell_1_1Intercalation__coll__graph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a6881fc85d2151cfe38a90f57f5846eaf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classICED_1_1HalfCell_1_1Intercalation.html">Intercalation</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Default constructor. </p>

<p>Definition at line <a class="el" href="PhysicsModule_8hpp_source.html#l00992">992</a> of file <a class="el" href="PhysicsModule_8hpp_source.html">PhysicsModule.hpp</a>.</p>

<p>References <a class="el" href="PhysicsModule_8hpp_source.html#l00726">OhmsLawElectrolyte::Initialize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;{<a class="code" href="classICED_1_1HalfCell_1_1Intercalation.html#a98b1050f09da390896f964fb7a892391">Initialize</a>();};</div>
<div class="ttc" id="classICED_1_1HalfCell_1_1Intercalation_html_a98b1050f09da390896f964fb7a892391"><div class="ttname"><a href="classICED_1_1HalfCell_1_1Intercalation.html#a98b1050f09da390896f964fb7a892391">ICED::HalfCell::Intercalation::Initialize</a></div><div class="ttdeci">void Initialize()</div><div class="ttdoc">Initialization of the member data. </div><div class="ttdef"><b>Definition:</b> <a href="PhysicsModule_8hpp_source.html#l01014">PhysicsModule.hpp:1014</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classICED_1_1HalfCell_1_1Intercalation_a6881fc85d2151cfe38a90f57f5846eaf_cgraph.svg" width="392" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad1b92c90c5d008a339742fb7454d7a4a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classICED_1_1HalfCell_1_1Intercalation.html">Intercalation</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classICED_1_1HalfCell_1_1SolutionData.html">SolutionData</a> *&#160;</td>
          <td class="paramname"><em>solutionData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceICED_1_1HalfCell.html#adaeddb6c345f1909b8c0482219d3147b">GlobalType</a> &amp;&#160;</td>
          <td class="paramname"><em>globin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor for solution data and global object. </p>

<p>Definition at line <a class="el" href="PhysicsModule_8hpp_source.html#l00997">997</a> of file <a class="el" href="PhysicsModule_8hpp_source.html">PhysicsModule.hpp</a>.</p>

<p>References <a class="el" href="PhysicsModule_8hpp_source.html#l01014">Intercalation::Initialize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                                                                  :</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;         <a class="code" href="classICED_1_1HalfCell_1_1PhysicsModule.html#afb8cce1b77073af99ba9fbd3de17f1c7">PhysicsModule</a>(solutionData, globin) {</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;      <a class="code" href="classICED_1_1HalfCell_1_1Intercalation.html#a98b1050f09da390896f964fb7a892391">Intercalation::Initialize</a>();</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    };</div>
<div class="ttc" id="classICED_1_1HalfCell_1_1PhysicsModule_html_afb8cce1b77073af99ba9fbd3de17f1c7"><div class="ttname"><a href="classICED_1_1HalfCell_1_1PhysicsModule.html#afb8cce1b77073af99ba9fbd3de17f1c7">ICED::HalfCell::PhysicsModule::PhysicsModule</a></div><div class="ttdeci">PhysicsModule()</div><div class="ttdoc">Default constructor. </div><div class="ttdef"><b>Definition:</b> <a href="PhysicsModule_8hpp_source.html#l00030">PhysicsModule.hpp:30</a></div></div>
<div class="ttc" id="classICED_1_1HalfCell_1_1Intercalation_html_a98b1050f09da390896f964fb7a892391"><div class="ttname"><a href="classICED_1_1HalfCell_1_1Intercalation.html#a98b1050f09da390896f964fb7a892391">ICED::HalfCell::Intercalation::Initialize</a></div><div class="ttdeci">void Initialize()</div><div class="ttdoc">Initialization of the member data. </div><div class="ttdef"><b>Definition:</b> <a href="PhysicsModule_8hpp_source.html#l01014">PhysicsModule.hpp:1014</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classICED_1_1HalfCell_1_1Intercalation_ad1b92c90c5d008a339742fb7454d7a4a_cgraph.svg" width="224" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="aac72e7caf7275f523a8096924012e434"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">~<a class="el" href="classICED_1_1HalfCell_1_1Intercalation.html">Intercalation</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Default destructor. </p>

<p>Definition at line <a class="el" href="PhysicsModule_8hpp_source.html#l01005">1005</a> of file <a class="el" href="PhysicsModule_8hpp_source.html">PhysicsModule.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;{};</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="abe661c3679eae6d6f40f0d6c4f38442b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double CalcATK </td>
          <td>(</td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>tau</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A Laplace transform is used to obtain series expansions for <img class="formulaInl" alt="$a(\tau)$" src="form_58.png"/>. </p>
<p>The CalcATK function obtains an expression for <img class="formulaInl" alt="$A_{kn}$" src="form_50.png"/> for the <a class="el" href="classICED_1_1HalfCell_1_1Intercalation.html" title="The Intercalation function is a module that solves the time-dependent, second-order diffusion equatio...">Intercalation</a> module. <img class="formulaInl" alt="$ A_{kn}$" src="form_180.png"/> is rewritten in a form that depends on <img class="formulaInl" alt="$a(t)$" src="form_53.png"/>. We use a Laplace transform to obtain series expansions for <img class="formulaInl" alt="$a(t)$" src="form_53.png"/>. A substitution occurs to change from dimensioned time <img class="formulaInl" alt="$t$" src="form_56.png"/> to dimensionless time <img class="formulaInl" alt="$\tau$" src="form_57.png"/>. There are two limits for <img class="formulaInl" alt="$a(t)$" src="form_53.png"/>, one valid for short times and one for long times.</p>
<p>At short times: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[a(\tau) = \frac{2}{\pi^2} \sum_{n=1}^{\infty} \frac{1}{n^2} \left[1-\exp(-n^2 \pi^2 \tau)\right]\]" src="form_181.png"/>
</p>
<p>At long times: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[a(\tau) = -\tau + 2 \left( \frac{\tau}{\pi} \right)^{0.5} \left\{1 + 2 \sum_{n=1}^{\infty} \left[\exp\left(-\frac{n^2}{\tau}\right) -n \sqrt{\frac{\pi}{\tau}} { \left( \frac{n}{\sqrt{\tau}} \right)} \right] \right\}\]" src="form_182.png"/>
</p>
<p>Here <img class="formulaInl" alt="$ \tau $" src="form_183.png"/> is the dimensionless time defined as: <img class="formulaInl" alt="$\tau = \frac{t D_s}{R^2}$" src="form_184.png"/></p>
<p><img class="formulaInl" alt="$ \cite{Doyle:1993}$" src="form_185.png"/> states that evaluating the first three terms of the short-time solution or the first five terms in the long-time solution provides sufficient accuracy.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000014">Todo:</a></b></dt><dd>We should test this assumption (should be easy with a unit test). The long-time solution is used when <img class="formulaInl" alt="$\tau$" src="form_57.png"/> &gt; 0.06. This solution assumes spherical particles. </dd></dl>

<p>Definition at line <a class="el" href="Intercalation_8cpp_source.html#l00021">21</a> of file <a class="el" href="Intercalation_8cpp_source.html">Intercalation.cpp</a>.</p>

<p>References <a class="el" href="Intercalation_8cpp_source.html#l00017">PI</a>.</p>

<p>Referenced by <a class="el" href="Intercalation_8cpp_source.html#l00048">Intercalation::InitializePhysics()</a>, and <a class="el" href="Intercalation_8cpp_source.html#l00076">Intercalation::SolvePhysics()</a>.</p>
<div class="fragment"><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;                                                 {</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keywordtype">double</span> value1=0.;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keywordtype">double</span> atk=0;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="comment">// different formulas for aTK depending on the value</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="comment">// of time (see notes document)</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="comment">// only the first 5 terms of the series expansion are computed</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="comment">// increased accurary could be obtained by calculating more...</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordflow">if</span>(tau &gt; 0 &amp;&amp; tau &lt;= 0.06) {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        atk = exp(-1.0/tau) - sqrt(<a class="code" href="Intercalation_8cpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a>/tau)*erfc(1.0/sqrt(tau));</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        atk += exp(-4.0/tau) - 2.0*sqrt(<a class="code" href="Intercalation_8cpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a>/tau)*erfc(2.0/sqrt(tau));</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        atk += exp(-9.0/tau) - 3.0*sqrt(<a class="code" href="Intercalation_8cpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a>/tau)*erfc(3.0/sqrt(tau));</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        atk = -tau + 2.0*sqrt(tau/<a class="code" href="Intercalation_8cpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a>)*(1.0 + 2.0*value1);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tau &gt; 0.06) {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      <span class="comment">//Ostr &lt;&lt; &quot;long tau&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      atk = 1.0 - exp(-<a class="code" href="Intercalation_8cpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a>*<a class="code" href="Intercalation_8cpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a>*tau);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      atk += 1.0/4.0*(1.0 - exp(-4.0*<a class="code" href="Intercalation_8cpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a>*<a class="code" href="Intercalation_8cpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a>*tau));</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      atk += 1.0/9.0*(1.0 - exp(-9.0*<a class="code" href="Intercalation_8cpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a>*<a class="code" href="Intercalation_8cpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a>*tau));</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      atk += 1.0/16.0*(1.0 - exp(-16.0*<a class="code" href="Intercalation_8cpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a>*<a class="code" href="Intercalation_8cpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a>*tau));</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      atk += 1.0/25.0*(1.0 - exp(-25.0*<a class="code" href="Intercalation_8cpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a>*<a class="code" href="Intercalation_8cpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a>*tau));</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      atk *= 2.0/(<a class="code" href="Intercalation_8cpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a>*<a class="code" href="Intercalation_8cpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a>);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordflow">return</span> atk;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  }</div>
<div class="ttc" id="Intercalation_8cpp_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="Intercalation_8cpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="Intercalation_8cpp_source.html#l00017">Intercalation.cpp:17</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classICED_1_1HalfCell_1_1Intercalation_abe661c3679eae6d6f40f0d6c4f38442b_icgraph.svg" width="251" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a98b1050f09da390896f964fb7a892391"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Initialize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialization of the member data. </p>
<dl class="section return"><dt>Returns</dt><dd>void</dd></dl>
<dl class="test"><dt><b><a class="el" href="test.html#_test000039">Test:</a></b></dt><dd>None </dd></dl>

<p>Definition at line <a class="el" href="PhysicsModule_8hpp_source.html#l01014">1014</a> of file <a class="el" href="PhysicsModule_8hpp_source.html">PhysicsModule.hpp</a>.</p>

<p>References <a class="el" href="SolutionData_8hpp_source.html#l00055">ICED::HalfCell::conc_s</a>, <a class="el" href="PhysicsModule_8hpp_source.html#l00198">PhysicsModule::idealParameters</a>, <a class="el" href="PhysicsModule_8hpp_source.html#l00200">PhysicsModule::moduleName</a>, and <a class="el" href="PhysicsModule_8hpp_source.html#l00194">PhysicsModule::variableIndex</a>.</p>

<p>Referenced by <a class="el" href="PhysicsModule_8hpp_source.html#l00997">Intercalation::Intercalation()</a>.</p>
<div class="fragment"><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                      {</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      <a class="code" href="classICED_1_1HalfCell_1_1PhysicsModule.html#a33bfba8d979c5f8e04408d23d7abb94f">moduleName</a>=<span class="stringliteral">&quot;Intercalation&quot;</span>;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      SetName(<a class="code" href="classICED_1_1HalfCell_1_1PhysicsModule.html#a33bfba8d979c5f8e04408d23d7abb94f">moduleName</a>);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      <a class="code" href="classICED_1_1HalfCell_1_1PhysicsModule.html#a73ebaa7a7e6791d96c63555ae1fefe26">variableIndex</a>=<a class="code" href="namespaceICED_1_1HalfCell.html#ab17cffca265630e7a0003ffcb3ebbe02a5c3aef4156edacf07dc82cefa48a5049">conc_s</a>;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    </div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;      <a class="code" href="classICED_1_1HalfCell_1_1PhysicsModule.html#ac37967782f9164e88f136226cfdb7d7d">idealParameters</a>.push_back(</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        IRAD::Primitive::KeyValuePairObj&lt;std::string,std::string&gt;(<span class="stringliteral">&quot;numNodes&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>));</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      <a class="code" href="classICED_1_1HalfCell_1_1PhysicsModule.html#ac37967782f9164e88f136226cfdb7d7d">idealParameters</a>.push_back(</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        IRAD::Primitive::KeyValuePairObj&lt;std::string,std::string&gt;(<span class="stringliteral">&quot;poreRadius&quot;</span>,<span class="stringliteral">&quot;4&quot;</span>));</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;      <a class="code" href="classICED_1_1HalfCell_1_1PhysicsModule.html#ac37967782f9164e88f136226cfdb7d7d">idealParameters</a>.push_back(</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;        IRAD::Primitive::KeyValuePairObj&lt;std::string,std::string&gt;(<span class="stringliteral">&quot;solidDiffusionCoefficient&quot;</span>,<span class="stringliteral">&quot;1&quot;</span>));</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    };</div>
<div class="ttc" id="classICED_1_1HalfCell_1_1PhysicsModule_html_ac37967782f9164e88f136226cfdb7d7d"><div class="ttname"><a href="classICED_1_1HalfCell_1_1PhysicsModule.html#ac37967782f9164e88f136226cfdb7d7d">ICED::HalfCell::PhysicsModule::idealParameters</a></div><div class="ttdeci">IRAD::Util::Parameters idealParameters</div><div class="ttdoc">The required parameters that need to be set in the input file for proper module operation Populated i...</div><div class="ttdef"><b>Definition:</b> <a href="PhysicsModule_8hpp_source.html#l00198">PhysicsModule.hpp:198</a></div></div>
<div class="ttc" id="namespaceICED_1_1HalfCell_html_ab17cffca265630e7a0003ffcb3ebbe02a5c3aef4156edacf07dc82cefa48a5049"><div class="ttname"><a href="namespaceICED_1_1HalfCell.html#ab17cffca265630e7a0003ffcb3ebbe02a5c3aef4156edacf07dc82cefa48a5049">ICED::HalfCell::conc_s</a></div><div class="ttdef"><b>Definition:</b> <a href="SolutionData_8hpp_source.html#l00055">SolutionData.hpp:55</a></div></div>
<div class="ttc" id="classICED_1_1HalfCell_1_1PhysicsModule_html_a33bfba8d979c5f8e04408d23d7abb94f"><div class="ttname"><a href="classICED_1_1HalfCell_1_1PhysicsModule.html#a33bfba8d979c5f8e04408d23d7abb94f">ICED::HalfCell::PhysicsModule::moduleName</a></div><div class="ttdeci">std::string moduleName</div><div class="ttdef"><b>Definition:</b> <a href="PhysicsModule_8hpp_source.html#l00200">PhysicsModule.hpp:200</a></div></div>
<div class="ttc" id="classICED_1_1HalfCell_1_1PhysicsModule_html_a73ebaa7a7e6791d96c63555ae1fefe26"><div class="ttname"><a href="classICED_1_1HalfCell_1_1PhysicsModule.html#a73ebaa7a7e6791d96c63555ae1fefe26">ICED::HalfCell::PhysicsModule::variableIndex</a></div><div class="ttdeci">solutionVariable_t variableIndex</div><div class="ttdoc">denotes the solution variable, this is set to solutionVariable_t_MAX if the module does not participa...</div><div class="ttdef"><b>Definition:</b> <a href="PhysicsModule_8hpp_source.html#l00194">PhysicsModule.hpp:194</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classICED_1_1HalfCell_1_1Intercalation_a98b1050f09da390896f964fb7a892391_icgraph.svg" width="224" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9b92f2697bb5f43111ccff9ef55ebef3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void InitializePhysics </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Physics solution initialization. </p>
<p>Sets things that do not change during the timestep. For intercalation, this involves putting the initial concentration and <img class="formulaInl" alt="$a(tau)$" src="form_179.png"/> functions onto the end of the list data structures. </p>

<p>Reimplemented from <a class="el" href="classICED_1_1HalfCell_1_1PhysicsModule.html#adb8fc779a8c9f73bac04af4dbbe6daa0">PhysicsModule</a>.</p>

<p>Definition at line <a class="el" href="Intercalation_8cpp_source.html#l00048">48</a> of file <a class="el" href="Intercalation_8cpp_source.html">Intercalation.cpp</a>.</p>

<p>References <a class="el" href="PhysicsModule_8hpp_source.html#l01083">Intercalation::aTK</a>, <a class="el" href="Intercalation_8cpp_source.html#l00021">Intercalation::CalcATK()</a>, <a class="el" href="SolutionData_8hpp_source.html#l00055">ICED::HalfCell::conc_s</a>, <a class="el" href="SolutionData_8hpp_source.html#l00423">SolutionData::iStartInternal</a>, <a class="el" href="SolutionData_8hpp_source.html#l00350">SolutionData::numNodes</a>, <a class="el" href="SolutionData_8hpp_source.html#l00376">SolutionData::poreRadius</a>, <a class="el" href="PhysicsModule_8hpp_source.html#l01073">Intercalation::prevConcS</a>, <a class="el" href="PhysicsModule_8hpp_source.html#l01077">Intercalation::prevTime</a>, <a class="el" href="PhysicsModule_8hpp_source.html#l00184">PhysicsModule::pSolutionData</a>, <a class="el" href="SolutionData_8hpp_source.html#l00357">SolutionData::solidDiffusionCoefficient</a>, <a class="el" href="SolutionData_8hpp_source.html#l00455">SolutionData::solutionData</a>, and <a class="el" href="SolutionData_8hpp_source.html#l00391">SolutionData::time</a>.</p>
<div class="fragment"><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                                        {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> numNodes = <a class="code" href="classICED_1_1HalfCell_1_1PhysicsModule.html#a18674158a96f67741ee3923729b39aae">pSolutionData</a>-&gt;<a class="code" href="classICED_1_1HalfCell_1_1SolutionData.html#aa253071e8bc5ba6c124e70c2aa373017">numNodes</a>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> iStartIn = <a class="code" href="classICED_1_1HalfCell_1_1PhysicsModule.html#a18674158a96f67741ee3923729b39aae">pSolutionData</a>-&gt;<a class="code" href="classICED_1_1HalfCell_1_1SolutionData.html#a5c2d70492a17c72ab643d7515e646960">iStartInternal</a>-1;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> iEndIn = <a class="code" href="classICED_1_1HalfCell_1_1PhysicsModule.html#a18674158a96f67741ee3923729b39aae">pSolutionData</a>-&gt; iEndInternal+1;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> solidDiff = <a class="code" href="classICED_1_1HalfCell_1_1PhysicsModule.html#a18674158a96f67741ee3923729b39aae">pSolutionData</a>-&gt;<a class="code" href="classICED_1_1HalfCell_1_1SolutionData.html#a3347a2e36d38a7a624ede72254f51103">solidDiffusionCoefficient</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> poreRadius = <a class="code" href="classICED_1_1HalfCell_1_1PhysicsModule.html#a18674158a96f67741ee3923729b39aae">pSolutionData</a>-&gt;<a class="code" href="classICED_1_1HalfCell_1_1SolutionData.html#a38ff7c61da2cb1eb0c4efa7fa31e4e24">poreRadius</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> time = <a class="code" href="classICED_1_1HalfCell_1_1PhysicsModule.html#a18674158a96f67741ee3923729b39aae">pSolutionData</a>-&gt;<a class="code" href="classICED_1_1HalfCell_1_1SolutionData.html#ab2d5aa7fce1a14d8bddfb2c333ea9679">time</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    std::vector&lt;double&gt; conc(numNodes);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    std::vector&lt; std::vector&lt;double&gt; &gt;* pSolution = <a class="code" href="classICED_1_1HalfCell_1_1PhysicsModule.html#a18674158a96f67741ee3923729b39aae">pSolutionData</a>-&gt;<a class="code" href="classICED_1_1HalfCell_1_1SolutionData.html#aeb2f51ded45b4ca66730922ffd7176bd">solutionData</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="comment">//set local conc vector to conc_s from solution data</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">//Ostr &lt;&lt; &quot;conc: &quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i= iStartIn; i &lt;= iEndIn; ++i){</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      conc[i] = (*pSolution)[i][<a class="code" href="namespaceICED_1_1HalfCell.html#ab17cffca265630e7a0003ffcb3ebbe02a5c3aef4156edacf07dc82cefa48a5049">conc_s</a>];</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="comment">//Ostr &lt;&lt; conc[i] &lt;&lt; std::endl; </span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="classICED_1_1HalfCell_1_1Intercalation.html#a2f31d252598029062370e89c338a3cf1">prevConcS</a>.push_back(conc);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="classICED_1_1HalfCell_1_1Intercalation.html#a2d39b99b2b3ecf1edc8636bc140abcd5">prevTime</a>.push_back(time);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">// calculate current tau, current aTK;</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordtype">double</span> tau = time*solidDiff/(poreRadius*poreRadius);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="classICED_1_1HalfCell_1_1Intercalation.html#a8c93a72506183b41a021ecb0c00c113f">aTK</a>.push_back(<a class="code" href="classICED_1_1HalfCell_1_1Intercalation.html#abe661c3679eae6d6f40f0d6c4f38442b">CalcATK</a>(tau));</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  }</div>
<div class="ttc" id="classICED_1_1HalfCell_1_1Intercalation_html_a2d39b99b2b3ecf1edc8636bc140abcd5"><div class="ttname"><a href="classICED_1_1HalfCell_1_1Intercalation.html#a2d39b99b2b3ecf1edc8636bc140abcd5">ICED::HalfCell::Intercalation::prevTime</a></div><div class="ttdeci">std::list&lt; double &gt; prevTime</div><div class="ttdoc">the list of times </div><div class="ttdef"><b>Definition:</b> <a href="PhysicsModule_8hpp_source.html#l01077">PhysicsModule.hpp:1077</a></div></div>
<div class="ttc" id="classICED_1_1HalfCell_1_1Intercalation_html_a8c93a72506183b41a021ecb0c00c113f"><div class="ttname"><a href="classICED_1_1HalfCell_1_1Intercalation.html#a8c93a72506183b41a021ecb0c00c113f">ICED::HalfCell::Intercalation::aTK</a></div><div class="ttdeci">std::list&lt; double &gt; aTK</div><div class="ttdoc">a list of a (surface area of the pore walls per unit volume) at every time step. </div><div class="ttdef"><b>Definition:</b> <a href="PhysicsModule_8hpp_source.html#l01083">PhysicsModule.hpp:1083</a></div></div>
<div class="ttc" id="classICED_1_1HalfCell_1_1SolutionData_html_aa253071e8bc5ba6c124e70c2aa373017"><div class="ttname"><a href="classICED_1_1HalfCell_1_1SolutionData.html#aa253071e8bc5ba6c124e70c2aa373017">ICED::HalfCell::SolutionData::numNodes</a></div><div class="ttdeci">int numNodes</div><div class="ttdef"><b>Definition:</b> <a href="SolutionData_8hpp_source.html#l00350">SolutionData.hpp:350</a></div></div>
<div class="ttc" id="classICED_1_1HalfCell_1_1Intercalation_html_a2f31d252598029062370e89c338a3cf1"><div class="ttname"><a href="classICED_1_1HalfCell_1_1Intercalation.html#a2f31d252598029062370e89c338a3cf1">ICED::HalfCell::Intercalation::prevConcS</a></div><div class="ttdeci">std::list&lt; std::vector&lt; double &gt; &gt; prevConcS</div><div class="ttdoc">conc_s at previous time steps. </div><div class="ttdef"><b>Definition:</b> <a href="PhysicsModule_8hpp_source.html#l01073">PhysicsModule.hpp:1073</a></div></div>
<div class="ttc" id="classICED_1_1HalfCell_1_1SolutionData_html_aeb2f51ded45b4ca66730922ffd7176bd"><div class="ttname"><a href="classICED_1_1HalfCell_1_1SolutionData.html#aeb2f51ded45b4ca66730922ffd7176bd">ICED::HalfCell::SolutionData::solutionData</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; * solutionData</div><div class="ttdoc">solution storage </div><div class="ttdef"><b>Definition:</b> <a href="SolutionData_8hpp_source.html#l00455">SolutionData.hpp:455</a></div></div>
<div class="ttc" id="classICED_1_1HalfCell_1_1SolutionData_html_a38ff7c61da2cb1eb0c4efa7fa31e4e24"><div class="ttname"><a href="classICED_1_1HalfCell_1_1SolutionData.html#a38ff7c61da2cb1eb0c4efa7fa31e4e24">ICED::HalfCell::SolutionData::poreRadius</a></div><div class="ttdeci">double poreRadius</div><div class="ttdef"><b>Definition:</b> <a href="SolutionData_8hpp_source.html#l00376">SolutionData.hpp:376</a></div></div>
<div class="ttc" id="classICED_1_1HalfCell_1_1PhysicsModule_html_a18674158a96f67741ee3923729b39aae"><div class="ttname"><a href="classICED_1_1HalfCell_1_1PhysicsModule.html#a18674158a96f67741ee3923729b39aae">ICED::HalfCell::PhysicsModule::pSolutionData</a></div><div class="ttdeci">ICED::HalfCell::SolutionData * pSolutionData</div><div class="ttdoc">member data </div><div class="ttdef"><b>Definition:</b> <a href="PhysicsModule_8hpp_source.html#l00184">PhysicsModule.hpp:184</a></div></div>
<div class="ttc" id="classICED_1_1HalfCell_1_1SolutionData_html_a5c2d70492a17c72ab643d7515e646960"><div class="ttname"><a href="classICED_1_1HalfCell_1_1SolutionData.html#a5c2d70492a17c72ab643d7515e646960">ICED::HalfCell::SolutionData::iStartInternal</a></div><div class="ttdeci">int iStartInternal</div><div class="ttdef"><b>Definition:</b> <a href="SolutionData_8hpp_source.html#l00423">SolutionData.hpp:423</a></div></div>
<div class="ttc" id="namespaceICED_1_1HalfCell_html_ab17cffca265630e7a0003ffcb3ebbe02a5c3aef4156edacf07dc82cefa48a5049"><div class="ttname"><a href="namespaceICED_1_1HalfCell.html#ab17cffca265630e7a0003ffcb3ebbe02a5c3aef4156edacf07dc82cefa48a5049">ICED::HalfCell::conc_s</a></div><div class="ttdef"><b>Definition:</b> <a href="SolutionData_8hpp_source.html#l00055">SolutionData.hpp:55</a></div></div>
<div class="ttc" id="classICED_1_1HalfCell_1_1SolutionData_html_ab2d5aa7fce1a14d8bddfb2c333ea9679"><div class="ttname"><a href="classICED_1_1HalfCell_1_1SolutionData.html#ab2d5aa7fce1a14d8bddfb2c333ea9679">ICED::HalfCell::SolutionData::time</a></div><div class="ttdeci">double time</div><div class="ttdef"><b>Definition:</b> <a href="SolutionData_8hpp_source.html#l00391">SolutionData.hpp:391</a></div></div>
<div class="ttc" id="classICED_1_1HalfCell_1_1Intercalation_html_abe661c3679eae6d6f40f0d6c4f38442b"><div class="ttname"><a href="classICED_1_1HalfCell_1_1Intercalation.html#abe661c3679eae6d6f40f0d6c4f38442b">ICED::HalfCell::Intercalation::CalcATK</a></div><div class="ttdeci">double CalcATK(const double &amp;tau)</div><div class="ttdoc">A Laplace transform is used to obtain series expansions for . </div><div class="ttdef"><b>Definition:</b> <a href="Intercalation_8cpp_source.html#l00021">Intercalation.cpp:21</a></div></div>
<div class="ttc" id="classICED_1_1HalfCell_1_1SolutionData_html_a3347a2e36d38a7a624ede72254f51103"><div class="ttname"><a href="classICED_1_1HalfCell_1_1SolutionData.html#a3347a2e36d38a7a624ede72254f51103">ICED::HalfCell::SolutionData::solidDiffusionCoefficient</a></div><div class="ttdeci">double solidDiffusionCoefficient</div><div class="ttdef"><b>Definition:</b> <a href="SolutionData_8hpp_source.html#l00357">SolutionData.hpp:357</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classICED_1_1HalfCell_1_1Intercalation_a9b92f2697bb5f43111ccff9ef55ebef3_cgraph.svg" width="251" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="acfbdf2d6a1bd474786c2f1c0bdf14dde"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SolvePhysics </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Physics solution. </p>
<p>Fills in the Function values for intercalation at every node in the mesh. It also populates the Jacobian matrices with the calculated values.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000013">Todo:</a></b></dt><dd>This is in need of a refactor. Once we are able to do problems of any size, we need to check the performance of of our list data structures. Surely there is a better way to implement this function. </dd></dl>

<p>Implements <a class="el" href="classICED_1_1HalfCell_1_1PhysicsModule.html#abd9de0e524a84c3c64bec82dc534a5d6">PhysicsModule</a>.</p>

<p>Definition at line <a class="el" href="Intercalation_8cpp_source.html#l00076">76</a> of file <a class="el" href="Intercalation_8cpp_source.html">Intercalation.cpp</a>.</p>

<p>References <a class="el" href="PhysicsModule_8hpp_source.html#l01083">Intercalation::aTK</a>, <a class="el" href="Intercalation_8cpp_source.html#l00021">Intercalation::CalcATK()</a>, <a class="el" href="SolutionData_8hpp_source.html#l00055">ICED::HalfCell::conc_s</a>, <a class="el" href="SolutionData_8hpp_source.html#l00457">SolutionData::function</a>, <a class="el" href="SolutionData_8hpp_source.html#l00423">SolutionData::iStartInternal</a>, <a class="el" href="SolutionData_8hpp_source.html#l00350">SolutionData::numNodes</a>, <a class="el" href="SolutionData_8hpp_source.html#l00376">SolutionData::poreRadius</a>, <a class="el" href="PhysicsModule_8hpp_source.html#l01073">Intercalation::prevConcS</a>, <a class="el" href="PhysicsModule_8hpp_source.html#l01077">Intercalation::prevTime</a>, <a class="el" href="PhysicsModule_8hpp_source.html#l00184">PhysicsModule::pSolutionData</a>, <a class="el" href="SolutionData_8hpp_source.html#l00357">SolutionData::solidDiffusionCoefficient</a>, <a class="el" href="SolutionData_8hpp_source.html#l00455">SolutionData::solutionData</a>, <a class="el" href="SolutionData_8hpp_source.html#l00391">SolutionData::time</a>, and <a class="el" href="SolutionData_8hpp_source.html#l00055">ICED::HalfCell::wallFlux</a>.</p>
<div class="fragment"><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                                  {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    FunctionEntry(<span class="stringliteral">&quot;SolvePhysics&quot;</span>);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    std::ostringstream Ostr;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    Ostr &lt;&lt; <span class="stringliteral">&quot;**************************************&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    Ostr &lt;&lt; <span class="stringliteral">&quot;**************************************&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    Ostr &lt;&lt; <span class="stringliteral">&quot;**************************************&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    Ostr &lt;&lt; <span class="stringliteral">&quot;Hello from SolvePhysics&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">//get all the component wide variables needed</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> iStartIn = <a class="code" href="classICED_1_1HalfCell_1_1PhysicsModule.html#a18674158a96f67741ee3923729b39aae">pSolutionData</a>-&gt;<a class="code" href="classICED_1_1HalfCell_1_1SolutionData.html#a5c2d70492a17c72ab643d7515e646960">iStartInternal</a>-1;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> iEndIn = <a class="code" href="classICED_1_1HalfCell_1_1PhysicsModule.html#a18674158a96f67741ee3923729b39aae">pSolutionData</a>-&gt; iEndInternal+1;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> numNodes = <a class="code" href="classICED_1_1HalfCell_1_1PhysicsModule.html#a18674158a96f67741ee3923729b39aae">pSolutionData</a>-&gt;<a class="code" href="classICED_1_1HalfCell_1_1SolutionData.html#aa253071e8bc5ba6c124e70c2aa373017">numNodes</a>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">//const int timeStep = pSolutionData-&gt;timeStep;</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> time = <a class="code" href="classICED_1_1HalfCell_1_1PhysicsModule.html#a18674158a96f67741ee3923729b39aae">pSolutionData</a>-&gt;<a class="code" href="classICED_1_1HalfCell_1_1SolutionData.html#ab2d5aa7fce1a14d8bddfb2c333ea9679">time</a>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">//const double deltaTime = pSolutionData-&gt;deltaTime;</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> solidDiff = <a class="code" href="classICED_1_1HalfCell_1_1PhysicsModule.html#a18674158a96f67741ee3923729b39aae">pSolutionData</a>-&gt;<a class="code" href="classICED_1_1HalfCell_1_1SolutionData.html#a3347a2e36d38a7a624ede72254f51103">solidDiffusionCoefficient</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> poreRadius = <a class="code" href="classICED_1_1HalfCell_1_1PhysicsModule.html#a18674158a96f67741ee3923729b39aae">pSolutionData</a>-&gt;<a class="code" href="classICED_1_1HalfCell_1_1SolutionData.html#a38ff7c61da2cb1eb0c4efa7fa31e4e24">poreRadius</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordtype">double</span> value1, value2, value3, tau;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">double</span> A1;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    std::vector&lt;double&gt; fkn(numNodes); <span class="comment">// f_{kn}</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    Ostr &lt;&lt; <span class="stringliteral">&quot;numNodes = &quot;</span> &lt;&lt; numNodes &lt;&lt; std::endl;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    Ostr &lt;&lt; <span class="stringliteral">&quot;iStartIn = &quot;</span> &lt;&lt; iStartIn &lt;&lt; std::endl;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    Ostr &lt;&lt; <span class="stringliteral">&quot;iEndIn = &quot;</span> &lt;&lt; iEndIn &lt;&lt; std::endl;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    std::vector&lt; std::vector&lt;double&gt; &gt;* pSolution = <a class="code" href="classICED_1_1HalfCell_1_1PhysicsModule.html#a18674158a96f67741ee3923729b39aae">pSolutionData</a>-&gt;<a class="code" href="classICED_1_1HalfCell_1_1SolutionData.html#aeb2f51ded45b4ca66730922ffd7176bd">solutionData</a>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">// declare some iterators</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    std::list&lt;double&gt;::iterator aTKIt;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    std::list&lt;double&gt;::iterator aTKItP1;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    std::list&lt; std::vector&lt;double&gt; &gt;::iterator prevConcSIt;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    std::list&lt; std::vector&lt;double&gt; &gt;::iterator prevConcSItP1;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    std::list&lt; std::vector&lt;double&gt; &gt;::iterator prevConcSItEnd;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    std::list&lt;double&gt;::iterator prevTimeIt;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    std::list&lt;double&gt;::iterator prevTimeItP1;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    std::vector&lt;double&gt; conc(numNodes);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">//set local conc vector to conc_s from solution data at the current time</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i= iStartIn; i &lt;= iEndIn; ++i){</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      conc[i] = (*pSolution)[i][<a class="code" href="namespaceICED_1_1HalfCell.html#ab17cffca265630e7a0003ffcb3ebbe02a5c3aef4156edacf07dc82cefa48a5049">conc_s</a>];</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">//Loop over all the nodes and initialize f_kn to wallFlux</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=iStartIn; i &lt;= iEndIn; ++i){</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      fkn[i] = (*pSolution)[i][<a class="code" href="namespaceICED_1_1HalfCell.html#ab17cffca265630e7a0003ffcb3ebbe02a457c4dc2a7d304b6b49f6517d3ce04e8">wallFlux</a>];</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">// contribution for current time step</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">// requires current value of concentration</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// last known concentration</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    prevConcSIt = <a class="code" href="classICED_1_1HalfCell_1_1Intercalation.html#a2f31d252598029062370e89c338a3cf1">prevConcS</a>.end();</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    --prevConcSIt; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">// last known time</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    prevTimeIt = <a class="code" href="classICED_1_1HalfCell_1_1Intercalation.html#a2d39b99b2b3ecf1edc8636bc140abcd5">prevTime</a>.end();</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    --prevTimeIt;  </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">// first and second values of a(tau)</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    aTKIt = <a class="code" href="classICED_1_1HalfCell_1_1Intercalation.html#a8c93a72506183b41a021ecb0c00c113f">aTK</a>.begin();</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    aTKItP1 = aTKIt; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    ++aTKItP1; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordtype">double</span> dt;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">// check for first time</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">// if this is the first time only the initial conditions exist</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">// in the prevConcS and aTK arrays, which means that we have to</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">// do something special</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">if</span> (prevConcSIt == <a class="code" href="classICED_1_1HalfCell_1_1Intercalation.html#a2f31d252598029062370e89c338a3cf1">prevConcS</a>.begin()) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      dt = time - *prevTimeIt;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      tau = <a class="code" href="classICED_1_1HalfCell_1_1PhysicsModule.html#a18674158a96f67741ee3923729b39aae">pSolutionData</a>-&gt;<a class="code" href="classICED_1_1HalfCell_1_1SolutionData.html#ab2d5aa7fce1a14d8bddfb2c333ea9679">time</a>*solidDiff/(poreRadius*poreRadius);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordtype">double</span> atk = <a class="code" href="classICED_1_1HalfCell_1_1Intercalation.html#abe661c3679eae6d6f40f0d6c4f38442b">CalcATK</a>(tau);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="comment">//Loop over all the nodes</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=iStartIn; i &lt;= iEndIn; ++i){</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        fkn[i] += (conc[i] - (*prevConcSIt)[i])</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                  <span class="comment">//*(atk - *aTKIt)*poreRadius/(solidDiff*dt);</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                  *(atk - *aTKIt)*poreRadius/(dt);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keywordtype">double</span> dt = time - *prevTimeIt;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="comment">//Loop over all the nodes</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=iStartIn; i &lt;= iEndIn; ++i){</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        fkn[i] += (conc[i] - (*prevConcSIt)[i])</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;               <span class="comment">//*(*aTKItP1 - *aTKIt)*poreRadius/(solidDiff*dt);</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;               *(*aTKItP1 - *aTKIt)*poreRadius/(dt);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="comment">// contribution for current time step</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="comment">// requires current value of a(tau)</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="comment">// first two known concentrations</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      prevConcSIt = <a class="code" href="classICED_1_1HalfCell_1_1Intercalation.html#a2f31d252598029062370e89c338a3cf1">prevConcS</a>.begin();</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      prevConcSItP1 = prevConcSIt; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      ++prevConcSItP1;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="comment">// first two times</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      prevTimeIt = <a class="code" href="classICED_1_1HalfCell_1_1Intercalation.html#a2d39b99b2b3ecf1edc8636bc140abcd5">prevTime</a>.begin();</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      prevTimeItP1 = prevTimeIt;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      ++prevTimeItP1;  </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <span class="comment">// last know value for a(tau)</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      aTKIt = <a class="code" href="classICED_1_1HalfCell_1_1Intercalation.html#a8c93a72506183b41a021ecb0c00c113f">aTK</a>.end();</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      --aTKIt; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      tau = <a class="code" href="classICED_1_1HalfCell_1_1PhysicsModule.html#a18674158a96f67741ee3923729b39aae">pSolutionData</a>-&gt;<a class="code" href="classICED_1_1HalfCell_1_1SolutionData.html#ab2d5aa7fce1a14d8bddfb2c333ea9679">time</a>*solidDiff/(poreRadius*poreRadius);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keywordtype">double</span> atk = <a class="code" href="classICED_1_1HalfCell_1_1Intercalation.html#abe661c3679eae6d6f40f0d6c4f38442b">CalcATK</a>(tau);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      dt = *prevTimeItP1 - *prevTimeIt;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="comment">//Loop over all the nodes</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=iStartIn; i &lt;= iEndIn; ++i){</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        fkn[i] += ((*prevConcSItP1)[i] - (*prevConcSIt)[i])</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;               <span class="comment">//*(atk - *aTKIt)*poreRadius/(solidDiff*dt);</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;               *(atk - *aTKIt)*poreRadius/(dt);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="comment">// Loop over all the previous time steps</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="comment">// this does not include the very first and most recent timesteps</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="comment">// as those calculations require access to values of concentration</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="comment">// and a(tau) that are not in our list</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="comment">// start on the second item and save an iterator to the next component </span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="comment">// due to our use of multiple lists, I think this would be more clear</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="comment">// if we used a random-access data structure. I don&#39;t think we are </span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="comment">// gaining any performance benefits (Mike Anderson)</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      aTKIt = <a class="code" href="classICED_1_1HalfCell_1_1Intercalation.html#a8c93a72506183b41a021ecb0c00c113f">aTK</a>.end();</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      --aTKIt;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      aTKItP1 = aTKIt;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      --aTKIt;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      prevTimeIt = <a class="code" href="classICED_1_1HalfCell_1_1Intercalation.html#a2d39b99b2b3ecf1edc8636bc140abcd5">prevTime</a>.begin();</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      ++prevTimeIt;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      prevTimeItP1 = prevTimeIt;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      ++prevTimeItP1;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      prevConcSIt = <a class="code" href="classICED_1_1HalfCell_1_1Intercalation.html#a2f31d252598029062370e89c338a3cf1">prevConcS</a>.begin();</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      ++prevConcSIt;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      prevConcSItEnd = <a class="code" href="classICED_1_1HalfCell_1_1Intercalation.html#a2f31d252598029062370e89c338a3cf1">prevConcS</a>.end();</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      --prevConcSItEnd;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="keywordflow">for</span>(prevConcSIt; prevConcSIt != prevConcSItEnd; prevConcSIt++){</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        prevConcSItP1 = prevConcSIt;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        ++prevConcSItP1;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="comment">//Ostr &lt;&lt; &quot;time = &quot; &lt;&lt; time &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="comment">//Ostr &lt;&lt; &quot;aTK = &quot; &lt;&lt; (*aTKIt) &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="comment">//Ostr &lt;&lt; &quot;aTK+1 = &quot; &lt;&lt; (*aTKItP1) &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="comment">//Loop over all the nodes</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        dt = *prevTimeItP1 - *prevTimeIt;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keywordtype">double</span> An = *aTKItP1 - *aTKIt;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=iStartIn; i &lt;= iEndIn; ++i) {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">            Ostr &lt;&lt; &quot;******************&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">            Ostr &lt;&lt; &quot;f_kn = &quot; &lt;&lt; (*pSolutionData-&gt;function)[i][4] &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">            Ostr &lt;&lt; &quot;node = &quot; &lt;&lt; i &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">            Ostr &lt;&lt; &quot;conc_k = &quot; &lt;&lt; (*prevConcSItP1)[i] &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">            Ostr &lt;&lt; &quot;conc_k-1 = &quot; &lt;&lt; (*prevConcSIt)[i] &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">            Ostr &lt;&lt; &quot;j = &quot; &lt;&lt; (*pSolution)[i][wallFlux] &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">            Ostr &lt;&lt; &quot;poreRadius = &quot; &lt;&lt; poreRadius &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">            Ostr &lt;&lt; &quot;solidDiff = &quot; &lt;&lt; solidDiff &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">            Ostr &lt;&lt; &quot;delta_c = &quot; &lt;&lt; ((*prevConcSItP1)[i]</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">                  - (*prevConcSIt)[i]) &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">            Ostr &lt;&lt; &quot;A = &quot; &lt;&lt; (*aTKItP1 - *aTKIt)*poreRadius/solidDiff &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;          fkn[i] += ((*prevConcSItP1)[i]</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                <span class="comment">//- (*prevConcSIt)[i])*An*poreRadius/(solidDiff*dt);</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                - (*prevConcSIt)[i])*An*poreRadius/(dt);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="comment">//first = false;</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        ++prevTimeIt;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        ++prevTimeItP1;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        --aTKIt;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        --aTKItP1;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">    //Print out f_kn to check</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">    Ostr &lt;&lt; &quot;f_kn:&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">    for(int i=iStartIn; i &lt;= iEndIn; ++i){</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">      Ostr &lt;&lt; (*pSolutionData-&gt;function)[i][4] &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=iStartIn; i &lt;= iEndIn; ++i){</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      (*<a class="code" href="classICED_1_1HalfCell_1_1PhysicsModule.html#a18674158a96f67741ee3923729b39aae">pSolutionData</a>-&gt;<a class="code" href="classICED_1_1HalfCell_1_1SolutionData.html#a679cf6d35d9953a46a1f23a27a50973b">function</a>)[i][<a class="code" href="namespaceICED_1_1HalfCell.html#ab17cffca265630e7a0003ffcb3ebbe02a5c3aef4156edacf07dc82cefa48a5049">conc_s</a>] = fkn[i];</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      Ostr &lt;&lt; <span class="stringliteral">&quot;computed Intercalation Function = &quot;</span> &lt;&lt; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        fkn[i] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">  commented out Jacobian stuff for now</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">  fix this later</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">    //calculate A1 to use in the Jacobian</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">    aTKIt = aTK.begin();</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">    value1 = *aTKIt;</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">    //Ostr &lt;&lt; &quot;aTK0 = &quot; &lt;&lt; value1 &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">    aTKIt++;</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">    value2 = *aTKIt;</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">    //Ostr &lt;&lt; &quot;aTK1 = &quot; &lt;&lt; value2 &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">    A1 = poreRadius/solidDiff*(value2 - value1);</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">    //Ostr &lt;&lt; &quot;A1 = &quot; &lt;&lt; A1 &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">    //Fill in the Jacobian values</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">    for(int i=iStartIn; i &lt;= iEndIn; ++i){</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">      (*pSolutionData-&gt;jacobian)[i][i][4][conc_s] = A1*solidDiff/deltaTime;</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">      (*pSolutionData-&gt;jacobian)[i][i][4][wallFlux] = 1.0;</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    Ostr &lt;&lt; std::endl;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    StdOut(Ostr.str(),3);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    FunctionExit(<span class="stringliteral">&quot;SolvePhysics&quot;</span>);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  };</div>
<div class="ttc" id="classICED_1_1HalfCell_1_1Intercalation_html_a2d39b99b2b3ecf1edc8636bc140abcd5"><div class="ttname"><a href="classICED_1_1HalfCell_1_1Intercalation.html#a2d39b99b2b3ecf1edc8636bc140abcd5">ICED::HalfCell::Intercalation::prevTime</a></div><div class="ttdeci">std::list&lt; double &gt; prevTime</div><div class="ttdoc">the list of times </div><div class="ttdef"><b>Definition:</b> <a href="PhysicsModule_8hpp_source.html#l01077">PhysicsModule.hpp:1077</a></div></div>
<div class="ttc" id="classICED_1_1HalfCell_1_1Intercalation_html_a8c93a72506183b41a021ecb0c00c113f"><div class="ttname"><a href="classICED_1_1HalfCell_1_1Intercalation.html#a8c93a72506183b41a021ecb0c00c113f">ICED::HalfCell::Intercalation::aTK</a></div><div class="ttdeci">std::list&lt; double &gt; aTK</div><div class="ttdoc">a list of a (surface area of the pore walls per unit volume) at every time step. </div><div class="ttdef"><b>Definition:</b> <a href="PhysicsModule_8hpp_source.html#l01083">PhysicsModule.hpp:1083</a></div></div>
<div class="ttc" id="classICED_1_1HalfCell_1_1SolutionData_html_aa253071e8bc5ba6c124e70c2aa373017"><div class="ttname"><a href="classICED_1_1HalfCell_1_1SolutionData.html#aa253071e8bc5ba6c124e70c2aa373017">ICED::HalfCell::SolutionData::numNodes</a></div><div class="ttdeci">int numNodes</div><div class="ttdef"><b>Definition:</b> <a href="SolutionData_8hpp_source.html#l00350">SolutionData.hpp:350</a></div></div>
<div class="ttc" id="classICED_1_1HalfCell_1_1Intercalation_html_a2f31d252598029062370e89c338a3cf1"><div class="ttname"><a href="classICED_1_1HalfCell_1_1Intercalation.html#a2f31d252598029062370e89c338a3cf1">ICED::HalfCell::Intercalation::prevConcS</a></div><div class="ttdeci">std::list&lt; std::vector&lt; double &gt; &gt; prevConcS</div><div class="ttdoc">conc_s at previous time steps. </div><div class="ttdef"><b>Definition:</b> <a href="PhysicsModule_8hpp_source.html#l01073">PhysicsModule.hpp:1073</a></div></div>
<div class="ttc" id="classICED_1_1HalfCell_1_1SolutionData_html_aeb2f51ded45b4ca66730922ffd7176bd"><div class="ttname"><a href="classICED_1_1HalfCell_1_1SolutionData.html#aeb2f51ded45b4ca66730922ffd7176bd">ICED::HalfCell::SolutionData::solutionData</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; * solutionData</div><div class="ttdoc">solution storage </div><div class="ttdef"><b>Definition:</b> <a href="SolutionData_8hpp_source.html#l00455">SolutionData.hpp:455</a></div></div>
<div class="ttc" id="classICED_1_1HalfCell_1_1SolutionData_html_a38ff7c61da2cb1eb0c4efa7fa31e4e24"><div class="ttname"><a href="classICED_1_1HalfCell_1_1SolutionData.html#a38ff7c61da2cb1eb0c4efa7fa31e4e24">ICED::HalfCell::SolutionData::poreRadius</a></div><div class="ttdeci">double poreRadius</div><div class="ttdef"><b>Definition:</b> <a href="SolutionData_8hpp_source.html#l00376">SolutionData.hpp:376</a></div></div>
<div class="ttc" id="classICED_1_1HalfCell_1_1SolutionData_html_a679cf6d35d9953a46a1f23a27a50973b"><div class="ttname"><a href="classICED_1_1HalfCell_1_1SolutionData.html#a679cf6d35d9953a46a1f23a27a50973b">ICED::HalfCell::SolutionData::function</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; * function</div><div class="ttdef"><b>Definition:</b> <a href="SolutionData_8hpp_source.html#l00457">SolutionData.hpp:457</a></div></div>
<div class="ttc" id="classICED_1_1HalfCell_1_1PhysicsModule_html_a18674158a96f67741ee3923729b39aae"><div class="ttname"><a href="classICED_1_1HalfCell_1_1PhysicsModule.html#a18674158a96f67741ee3923729b39aae">ICED::HalfCell::PhysicsModule::pSolutionData</a></div><div class="ttdeci">ICED::HalfCell::SolutionData * pSolutionData</div><div class="ttdoc">member data </div><div class="ttdef"><b>Definition:</b> <a href="PhysicsModule_8hpp_source.html#l00184">PhysicsModule.hpp:184</a></div></div>
<div class="ttc" id="classICED_1_1HalfCell_1_1SolutionData_html_a5c2d70492a17c72ab643d7515e646960"><div class="ttname"><a href="classICED_1_1HalfCell_1_1SolutionData.html#a5c2d70492a17c72ab643d7515e646960">ICED::HalfCell::SolutionData::iStartInternal</a></div><div class="ttdeci">int iStartInternal</div><div class="ttdef"><b>Definition:</b> <a href="SolutionData_8hpp_source.html#l00423">SolutionData.hpp:423</a></div></div>
<div class="ttc" id="namespaceICED_1_1HalfCell_html_ab17cffca265630e7a0003ffcb3ebbe02a5c3aef4156edacf07dc82cefa48a5049"><div class="ttname"><a href="namespaceICED_1_1HalfCell.html#ab17cffca265630e7a0003ffcb3ebbe02a5c3aef4156edacf07dc82cefa48a5049">ICED::HalfCell::conc_s</a></div><div class="ttdef"><b>Definition:</b> <a href="SolutionData_8hpp_source.html#l00055">SolutionData.hpp:55</a></div></div>
<div class="ttc" id="classICED_1_1HalfCell_1_1SolutionData_html_ab2d5aa7fce1a14d8bddfb2c333ea9679"><div class="ttname"><a href="classICED_1_1HalfCell_1_1SolutionData.html#ab2d5aa7fce1a14d8bddfb2c333ea9679">ICED::HalfCell::SolutionData::time</a></div><div class="ttdeci">double time</div><div class="ttdef"><b>Definition:</b> <a href="SolutionData_8hpp_source.html#l00391">SolutionData.hpp:391</a></div></div>
<div class="ttc" id="namespaceICED_1_1HalfCell_html_ab17cffca265630e7a0003ffcb3ebbe02a457c4dc2a7d304b6b49f6517d3ce04e8"><div class="ttname"><a href="namespaceICED_1_1HalfCell.html#ab17cffca265630e7a0003ffcb3ebbe02a457c4dc2a7d304b6b49f6517d3ce04e8">ICED::HalfCell::wallFlux</a></div><div class="ttdef"><b>Definition:</b> <a href="SolutionData_8hpp_source.html#l00055">SolutionData.hpp:55</a></div></div>
<div class="ttc" id="classICED_1_1HalfCell_1_1Intercalation_html_abe661c3679eae6d6f40f0d6c4f38442b"><div class="ttname"><a href="classICED_1_1HalfCell_1_1Intercalation.html#abe661c3679eae6d6f40f0d6c4f38442b">ICED::HalfCell::Intercalation::CalcATK</a></div><div class="ttdeci">double CalcATK(const double &amp;tau)</div><div class="ttdoc">A Laplace transform is used to obtain series expansions for . </div><div class="ttdef"><b>Definition:</b> <a href="Intercalation_8cpp_source.html#l00021">Intercalation.cpp:21</a></div></div>
<div class="ttc" id="classICED_1_1HalfCell_1_1SolutionData_html_a3347a2e36d38a7a624ede72254f51103"><div class="ttname"><a href="classICED_1_1HalfCell_1_1SolutionData.html#a3347a2e36d38a7a624ede72254f51103">ICED::HalfCell::SolutionData::solidDiffusionCoefficient</a></div><div class="ttdeci">double solidDiffusionCoefficient</div><div class="ttdef"><b>Definition:</b> <a href="SolutionData_8hpp_source.html#l00357">SolutionData.hpp:357</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classICED_1_1HalfCell_1_1Intercalation_acfbdf2d6a1bd474786c2f1c0bdf14dde_cgraph.svg" width="238" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a8c93a72506183b41a021ecb0c00c113f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::list&lt;double&gt; aTK</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>a list of a (surface area of the pore walls per unit volume) at every time step. </p>
<p>Equation for aTK: <img class="formulaInl" alt="$a(t_k) = \frac{D}{R} \int_0^{t_k} \frac{\partial c_n}{\partial r} (R, \delta) d \delta$" src="form_186.png"/> </p>

<p>Definition at line <a class="el" href="PhysicsModule_8hpp_source.html#l01083">1083</a> of file <a class="el" href="PhysicsModule_8hpp_source.html">PhysicsModule.hpp</a>.</p>

<p>Referenced by <a class="el" href="Intercalation_8cpp_source.html#l00048">Intercalation::InitializePhysics()</a>, and <a class="el" href="Intercalation_8cpp_source.html#l00076">Intercalation::SolvePhysics()</a>.</p>

</div>
</div>
<a class="anchor" id="a2f31d252598029062370e89c338a3cf1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::list&lt; std::vector&lt;double&gt; &gt; prevConcS</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>conc_s at previous time steps. </p>

<p>Definition at line <a class="el" href="PhysicsModule_8hpp_source.html#l01073">1073</a> of file <a class="el" href="PhysicsModule_8hpp_source.html">PhysicsModule.hpp</a>.</p>

<p>Referenced by <a class="el" href="Intercalation_8cpp_source.html#l00048">Intercalation::InitializePhysics()</a>, and <a class="el" href="Intercalation_8cpp_source.html#l00076">Intercalation::SolvePhysics()</a>.</p>

</div>
</div>
<a class="anchor" id="a2d39b99b2b3ecf1edc8636bc140abcd5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::list&lt;double&gt; prevTime</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the list of times </p>

<p>Definition at line <a class="el" href="PhysicsModule_8hpp_source.html#l01077">1077</a> of file <a class="el" href="PhysicsModule_8hpp_source.html">PhysicsModule.hpp</a>.</p>

<p>Referenced by <a class="el" href="Intercalation_8cpp_source.html#l00048">Intercalation::InitializePhysics()</a>, and <a class="el" href="Intercalation_8cpp_source.html#l00076">Intercalation::SolvePhysics()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="PhysicsModule_8hpp_source.html">PhysicsModule.hpp</a></li>
<li><a class="el" href="Intercalation_8cpp_source.html">Intercalation.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceICED.html">ICED</a></li><li class="navelem"><a class="el" href="namespaceICED_1_1HalfCell.html">HalfCell</a></li><li class="navelem"><a class="el" href="classICED_1_1HalfCell_1_1Intercalation.html">Intercalation</a></li>
    <li class="footer">Generated on Tue Nov 10 2015 16:35:52 for ICED_Physics by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
